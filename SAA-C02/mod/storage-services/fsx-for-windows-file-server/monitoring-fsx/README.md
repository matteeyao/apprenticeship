# Monitoring FSx for Windows File Server

With your file system up and running, you can now monitor its activity, performance, capacity, and usage. 

You can monitor file system performance and storage capacity using Amazon CloudWatch. Monitor Amazon API calls using AWS CloudTrail.

![Fig. 1 Monitoring file system performance](../../../../../img/SAA-CO2/storage-services/fsx-for-windows-file-server/monitoring-fsx/diag01.jpeg)

## Introduction to Amazon CloudWatch

Amazon CloudWatch collects and processes data from FSx for Windows File Server into readable, near-real-time metrics that allow you to monitor performance and capacity. The following FSx for Windows File Server metrics are available in CloudWatch.

<table style="border-collapse:collapse;border:none;width:100%;"><tbody><tr><td style="width:37.2156%;border:1pt solid windowtext;padding:0in 5.4pt;vertical-align:top;"><p><span style="font-size:17px;"><strong>Metric</strong></span></p></td><td style="width:62.6522%;border-top:1pt solid windowtext;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-image:initial;border-left:none;padding:0in 5.4pt;vertical-align:top;"><p><span style="font-size:17px;"><strong>Description</strong></span></p></td></tr><tr><td style="width:37.2156%;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-image:initial;border-top:none;padding:0in 5.4pt;vertical-align:top;"><p><span style="font-size:17px;">DataReadBytes</span></p></td><td style="width:62.6522%;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;vertical-align:top;"><p><span style="font-size:17px;">Number of bytes for file system read operations</span></p></td></tr><tr><td style="width:37.2156%;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-image:initial;border-top:none;padding:0in 5.4pt;vertical-align:top;"><p><span style="font-size:17px;">DataWriteBytes</span></p></td><td style="width:62.6522%;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;vertical-align:top;"><p><span style="font-size:17px;">Number of bytes for file system write operations</span></p></td></tr><tr><td style="width:37.2156%;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-image:initial;border-top:none;padding:0in 5.4pt;vertical-align:top;"><p><span style="font-size:17px;">DataReadOperations</span></p></td><td style="width:62.6522%;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;vertical-align:top;"><p><span style="font-size:17px;">Number of read operations</span></p></td></tr><tr><td style="width:37.2156%;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-image:initial;border-top:none;padding:0in 5.4pt;vertical-align:top;"><p><span style="font-size:17px;">DataWriteOperations</span></p></td><td style="width:62.6522%;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;vertical-align:top;"><p><span style="font-size:17px;">Number of write operations</span></p></td></tr><tr><td style="width:37.2156%;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-image:initial;border-top:none;padding:0in 5.4pt;vertical-align:top;"><p><span style="font-size:17px;">MetadataOperations &nbsp; &nbsp;&nbsp;</span></p></td><td style="width:62.6522%;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;vertical-align:top;"><p><span style="font-size:17px;">Number of metadata operations</span></p></td></tr><tr><td style="width:37.2156%;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-image:initial;border-top:none;padding:0in 5.4pt;vertical-align:top;"><p><span style="font-size:17px;">FreeStorageCapacity</span></p></td><td style="width:62.6522%;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;vertical-align:top;"><p><span style="font-size:17px;">Amount of available storage capacity</span></p></td></tr></tbody></table>

### Querying multiple CloudWatch metrics using math expressions

You can use math expressions to perform math analytics across multiple CloudWatch metrics. These analytics simplify real-time monitoring of your file system's health and performance. Math expressions support simple mathematical operations for CloudWatch metrics, such as addition, subtraction, and other functions. You can develop new metrics using math expressions, as you combine and perform different math calculations on existing metrics. For example, to get the total number of bytes for your file system operations, you can add the DataReadBytes and DataWriteBytes metrics by using this expression:

```
TotalThroughput = Sum(DataReadBytes+DataWriteBytes)
```

You can visualize the resulting time series on the CloudWatch console and add them to CloudWatch dashboards.

### CloudWatch alarms overview 

CloudWatch alarms enable you to receive notifications when an alarm changes state. An alarm watches a metric and performs actions when the metrics fall outside of the thresholds that you configure. For example, you can create an alarm to email an administrator when the free storage capacity of a file system drops below a particular threshold. A CloudWatch alarm has the following possible states:

<table style="border-collapse:collapse;border:none;width:100%;margin-right:calc(0%);"><tbody><tr><td style="width:121.25pt;border:1pt solid windowtext;padding:0in 5.4pt;vertical-align:top;"><p><strong>Alarm state</strong></p></td><td style="width:346.25pt;border-top:1pt solid windowtext;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-image:initial;border-left:none;padding:0in 5.4pt;vertical-align:top;"><p><strong>Description</strong></p></td></tr><tr><td style="width:121.25pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-image:initial;border-top:none;padding:0in 5.4pt;vertical-align:top;"><p>OK</p></td><td style="width:346.25pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;vertical-align:top;"><p>The metric is within the range that you have defined as acceptable.</p></td></tr><tr><td style="width:121.25pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-image:initial;border-top:none;padding:0in 5.4pt;vertical-align:top;"><p>ALARM</p></td><td style="width:346.25pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;vertical-align:top;"><p>The metric is outside of the defined threshold.</p></td></tr><tr><td style="width:121.25pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-image:initial;border-top:none;padding:0in 5.4pt;vertical-align:top;"><p>INSUFFICIENT_DATA</p></td><td style="width:346.25pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0in 5.4pt;vertical-align:top;"><p>The alarm has just started, the metric is not available, or not enough data is available.</p></td></tr></tbody></table>

You can create an alarm from the FSx for Windows File Server console or the CloudWatch console.

## Logging FSx for Windows File Server API calls with AWS CloudTrail 

FSx for Windows File Server also integrates with AWS CloudTrail. CloudTrail is a service that provides a record of actions taken by any users, roles, or AWS services in FSx for Windows File Server. CloudTrail captures all API calls for FSx for Windows File Server as events. These calls include calls from the FSx for Windows File Server console and code calls to the FSx for Windows File Server API operations.

If you create a trail, you can enable continuous delivery of CloudTrail events to an Amazon S3 bucket, including events for FSx for Windows File Server. If you don't configure a trail, you can still view the most recent events in the CloudTrail console. Using the information collected by CloudTrail, you can determine the type of requests that FSx for Windows File Server received, the IP addresses from which the requests originated, who made the requests, and additional details.
